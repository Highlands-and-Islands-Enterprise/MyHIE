var Leidos = window.Leidos || {};


 Leidos.filterLookupContact = function(executionContext) {

    var formContext = executionContext.getFormContext();

//Check if the control exist on the form

            if (formContext.getControl("header_process_primarycontactid") != null) {

            // add the event handler for PreSearch Event

            formContext.getControl("header_process_primarycontactid").addPreSearch(Leidos.addFilter);

    }

}

 Leidos.addFilter = function(executionContext) {

        var formContext = executionContext.getFormContext();
        var accountId = formContext.data.entity.getId();

        var fetchQuery; 

                

        //Build fetch

        if (accountId != null || accountId != undefined) {

        fetchQuery = "<filter type='and'>" +

        "<condition attribute='statecode' operator='eq' value='0' />" +

        "<condition attribute='parentcustomerid' operator='eq' value='" + accountId + "' />" +

        "</filter>";

        //add custom filter

        formContext.getControl("header_process_primarycontactid").addCustomFilter(fetchQuery);

        }

 

}