{"properties":{"connectionReferences":{"shared_flowmanagement_1":{"runtimeSource":"embedded","connection":{"connectionReferenceLogicalName":"leidos_ConnPowerAutomateforAdmins"},"api":{"name":"shared_flowmanagement"}}},"definition":{"$schema":"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#","contentVersion":"1.0.0.0","parameters":{"$connections":{"defaultValue":{},"type":"Object"},"$authentication":{"defaultValue":{},"type":"SecureObject"}},"triggers":{"Recurrence":{"recurrence":{"frequency":"Day","interval":1,"timeZone":"Morocco Standard Time","schedule":{"hours":["5"]}},"type":"Recurrence"}},"actions":{"List_My_Environments":{"runAfter":{},"type":"OpenApiConnection","inputs":{"host":{"connectionName":"shared_flowmanagement_1","operationId":"ListUserEnvironments","apiId":"/providers/Microsoft.PowerApps/apis/shared_flowmanagement"},"parameters":{},"authentication":"@parameters('$authentication')"}},"Apply_to_each_Enviroment":{"foreach":"@outputs('List_My_Environments')?['body/value']","actions":{"List_Flows_as_Admin_3":{"runAfter":{},"type":"OpenApiConnection","inputs":{"host":{"connectionName":"shared_flowmanagement_1","operationId":"ListFlowsInEnvironment","apiId":"/providers/Microsoft.PowerApps/apis/shared_flowmanagement"},"parameters":{"environmentName":"@items('Apply_to_each_Enviroment')?['name']"},"authentication":"@parameters('$authentication')"}},"Select_Array":{"runAfter":{"Filter_array__of_Flows_to_only_Suspended":["Succeeded"]},"type":"Select","inputs":{"from":"@body('Filter_array__of_Flows_to_only_Suspended')","select":{"name":"@item()?['name']","state":"@item()?['properties']?['state']","displayname":"@item()?['properties']?['displayName']","enviroment":"@items('Apply_to_each_Enviroment')?['name']"}}},"Filter_array__of_Flows_to_only_Suspended":{"runAfter":{"List_Flows_as_Admin_3":["Succeeded"]},"type":"Query","inputs":{"from":"@outputs('List_Flows_as_Admin_3')?['body/value']","where":"@equals(item()?['properties/state'], 'Suspended')"}}},"runAfter":{"List_My_Environments":["Succeeded"]},"type":"Foreach"},"Compose_Select":{"runAfter":{"Apply_to_each_Enviroment":["Succeeded"]},"type":"Compose","inputs":"@outputs('Select_Array')"},"Apply_to_each_Flow":{"foreach":"@outputs('Compose_Select')","actions":{"Suspended_Flows_Within_Environment":{"runAfter":{},"type":"Compose","inputs":"@items('Apply_to_each_Flow')"},"Apply_to_each_Suspended_Flow_in_Environment":{"foreach":"@items('Apply_to_each_Flow')?['body']","actions":{"Flow_Environment_Name":{"runAfter":{},"type":"Compose","inputs":"@items('Apply_to_each_Suspended_Flow_in_Environment')?['enviroment']"},"Flow_Flow_Name":{"runAfter":{"Flow_Environment_Name":["Succeeded"]},"type":"Compose","inputs":"@items('Apply_to_each_Suspended_Flow_in_Environment')?['name']"},"Turn_On_Flow":{"runAfter":{"Flow_Flow_Name":["Succeeded"]},"type":"OpenApiConnection","inputs":{"host":{"connectionName":"shared_flowmanagement_1","operationId":"StartFlow","apiId":"/providers/Microsoft.PowerApps/apis/shared_flowmanagement"},"parameters":{"environmentName":"@outputs('Flow_Environment_Name')","flowName":"@outputs('Flow_Flow_Name')"},"authentication":"@parameters('$authentication')"}}},"runAfter":{"Suspended_Flows_Within_Environment":["Succeeded"]},"type":"Foreach"}},"runAfter":{"Compose_Select":["Succeeded"]},"type":"Foreach"}},"outputs":{}}},"schemaVersion":"1.0.0.0"}